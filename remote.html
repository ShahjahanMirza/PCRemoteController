<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PC Remote</title>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            --bg: #0a0a0a;
            --surface-2: #1e1e1e;
            --accent: #3b82f6;
            --accent-hover: #2563eb;
            --text: #ffffff;
            --text-dim: #94a3b8;
            --border: rgba(255,255,255,0.06);
        }
        * { box-sizing: border-box; margin: 0; padding: 0; user-select: none; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--bg); color: var(--text);
            height: 100vh; display: flex; flex-direction: column;
            align-items: center; overflow-y: auto; overflow-x: hidden;
        }
        .remote-container {
            display: flex; flex-direction: column;
            gap: 14px; padding: 16px 12px 30px;
            align-items: center; width: 100%; max-width: 420px;
        }
        .remote-header {
            display: flex; align-items: center; gap: 10px;
            width: 100%; padding: 8px 4px;
        }
        .remote-header .dot { width: 8px; height: 8px; background: #22c55e; border-radius: 50%; }
        .remote-header span { font-size: 13px; color: var(--text-dim); }
        .row { display: flex; gap: 10px; justify-content: center; width: 100%; }
        .btn {
            background: var(--surface-2);
            border: 1px solid var(--border);
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            transition: all 0.1s ease; color: #ccc; cursor: pointer;
        }
        .btn:active, .active-hold {
            transform: scale(0.95);
            background: #2a2a2a !important;
            border-color: var(--accent);
        }
        .btn-header { width: 130px; height: 56px; }
        .btn-std { width: 76px; height: 56px; }
        .btn-mouse {
            width: calc(50% - 5px); height: 48px;
            background: #161616; font-size: 11px; font-weight: 700; letter-spacing: 0.5px;
        }
        .btn-extra {
            width: calc(50% - 5px); height: 38px;
            background: #131313; font-size: 10px; color: var(--text-dim); font-weight: 600;
        }
        .btn-play {
            width: 76px; height: 56px;
            background: var(--accent); color: white; border: none;
        }
        .btn-play:active { background: var(--accent-hover); }
        .trackpad-container {
            display: flex; gap: 16px;
            width: calc(100% + 24px); height: 260px;
        }
        #trackpad {
            flex: 1; height: 100%; background: #080808;
            border: 1px solid var(--border); border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            color: rgba(255,255,255,0.08); font-size: 10px;
            text-transform: uppercase; letter-spacing: 2px; touch-action: none;
        }
        #scroll-bar {
            width: 38px; height: 100%; background: #161616;
            border: 1px solid var(--border); border-radius: 12px;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            color: rgba(255,255,255,0.15); touch-action: none;
        }
        .btn-kb {
            width: 48px; height: 38px; background: #1a1a1a;
            color: var(--accent); border: 1px solid rgba(59,130,246,0.25);
        }
        #hidden-input {
            position: absolute; left: -9999px; top: -9999px;
            opacity: 0; pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="remote-container">
        <div class="remote-header">
            <div class="dot"></div>
            <span>PC Remote â€” Connected</span>
        </div>
        <div class="row">
            <div class="btn btn-header" onclick="send('esc')"><i data-lucide="minimize-2"></i></div>
            <div class="btn btn-header" onclick="send('double_click')"><i data-lucide="maximize"></i></div>
        </div>
        <div class="row">
            <div class="btn btn-std" onclick="send('arrow_left')"><i data-lucide="skip-back"></i></div>
            <div class="btn btn-play" onclick="send('play')"><i data-lucide="play" id="play-icon"></i></div>
            <div class="btn btn-std" onclick="send('arrow_right')"><i data-lucide="skip-forward"></i></div>
        </div>
        <div class="row">
            <div class="btn btn-std" onclick="send('arrow_down')"><i data-lucide="volume-1"></i></div>
            <div class="btn btn-std" onclick="send('mute')"><i data-lucide="volume-x" id="mute-icon"></i></div>
            <div class="btn btn-std" onclick="send('arrow_up')"><i data-lucide="volume-2"></i></div>
        </div>
        <div class="row">
            <div class="btn btn-mouse" id="left-click-btn">LEFT CLICK</div>
            <div class="btn btn-mouse" id="right-click-btn">RIGHT CLICK</div>
        </div>
        <div class="trackpad-container">
            <div id="trackpad">Trackpad</div>
            <div id="scroll-bar"><i data-lucide="chevrons-up-down" style="width:16px;opacity:0.5;"></i></div>
        </div>
        <div class="row">
            <div class="btn btn-extra" id="x1-btn">MOUSE 4</div>
            <div class="btn btn-extra" id="x2-btn">MOUSE 5</div>
        </div>
        <div class="row">
            <div class="btn btn-kb" id="kb-btn" onclick="toggleKeyboard()"><i data-lucide="keyboard"></i></div>
        </div>
        <input type="text" id="hidden-input" autocomplete="off" autocapitalize="off" spellcheck="false">
    </div>

    <script>
        let playState = false, muteState = false;
        lucide.createIcons();

        function send(cmd, params = '') {
            const url = `/${cmd}${params}`;
            if (cmd === 'play') {
                playState = !playState;
                document.getElementById('play-icon').setAttribute('data-lucide', playState ? 'pause' : 'play');
                lucide.createIcons();
            }
            if (cmd === 'mute') {
                muteState = !muteState;
                document.getElementById('mute-icon').setAttribute('data-lucide', muteState ? 'volume-2' : 'volume-x');
                lucide.createIcons();
            }
            fetch(url, { mode: 'no-cors' }).catch(() => {});
        }

        // Trackpad
        const trackpad = document.getElementById('trackpad');
        let lastX = 0, lastY = 0, isMoving = false, touchStartTime = 0;
        trackpad.addEventListener('touchstart', e => {
            const t = e.touches[0]; lastX = t.clientX; lastY = t.clientY;
            isMoving = false; touchStartTime = Date.now();
        });
        trackpad.addEventListener('touchmove', e => {
            e.preventDefault();
            const t = e.touches[0];
            const dx = (t.clientX - lastX) * 2, dy = (t.clientY - lastY) * 2;
            if (Math.abs(dx) > 0.1 || Math.abs(dy) > 0.1) {
                send('mouse_move', `?dx=${dx}&dy=${dy}`); isMoving = true;
            }
            lastX = t.clientX; lastY = t.clientY;
        }, { passive: false });
        trackpad.addEventListener('touchend', () => {
            if (!isMoving || Date.now() - touchStartTime < 100) send('left_click');
        });

        // Scroll
        const scrollBar = document.getElementById('scroll-bar');
        let lastScrollY = 0;
        scrollBar.addEventListener('touchstart', e => { lastScrollY = e.touches[0].clientY; });
        scrollBar.addEventListener('touchmove', e => {
            e.preventDefault();
            const dy = (lastScrollY - e.touches[0].clientY) * 5;
            if (Math.abs(dy) > 1) { send('scroll', `?dy=${Math.round(dy)}`); lastScrollY = e.touches[0].clientY; }
        }, { passive: false });

        // Hold buttons
        function setupHold(id, btn) {
            const el = document.getElementById(id); if (!el) return;
            el.addEventListener('touchstart', e => { e.preventDefault(); send('mouse_down', `?button=${btn}`); el.classList.add('active-hold'); });
            el.addEventListener('touchend', e => { e.preventDefault(); send('mouse_up', `?button=${btn}`); el.classList.remove('active-hold'); });
        }
        setupHold('left-click-btn', 'left'); setupHold('right-click-btn', 'right');
        setupHold('x1-btn', 'x1'); setupHold('x2-btn', 'x2');

        // Keyboard
        const hiddenInput = document.getElementById('hidden-input');
        let lastValue = '';
        hiddenInput.addEventListener('input', () => {
            const val = hiddenInput.value;
            if (val.length > lastValue.length) send('type', `?text=${encodeURIComponent(val.charAt(val.length - 1))}`);
            lastValue = val;
            if (val.length > 20) { hiddenInput.value = ''; lastValue = ''; }
        });
        hiddenInput.addEventListener('keydown', e => {
            if (e.key === 'Backspace') send('press_key', '?key=backspace');
            else if (e.key === 'Enter') send('press_key', '?key=enter');
        });
        function toggleKeyboard() {
            hiddenInput.focus();
            const btn = document.getElementById('kb-btn');
            btn.style.transform = 'scale(1.1)'; setTimeout(() => btn.style.transform = 'scale(1)', 100);
        }
        document.addEventListener('touchstart', e => { if (e.touches.length > 1) e.preventDefault(); }, { passive: false });
    </script>
</body>
</html>
